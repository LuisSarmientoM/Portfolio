---
import type { MarkdownInstance } from 'astro';
import BaseLayout from '../../layouts/BaseLayout.astro';
import resume from '../../data/resume.json';

const posts = Object.values(
  import.meta.glob<MarkdownInstance<Record<string, any>>>('./*.md', { eager: true })
) as MarkdownInstance<Record<string, any>>[];
const sorted = posts.sort((a, b) => new Date(b.frontmatter.date).getTime() - new Date(a.frontmatter.date).getTime());

type TranslationKey = keyof typeof resume.translations;
const languages = resume.languages;
const translationKeys = Object.keys(resume.translations) as TranslationKey[];
const defaultLanguage = (languages[0]?.code as TranslationKey) ?? translationKeys[0];
const translation = resume.translations[defaultLanguage];
---
<BaseLayout
  name={translation.profile.name}
  languages={languages}
  currentLanguage={defaultLanguage}
  defaultLanguage={defaultLanguage}
>
  <Fragment slot="head">
    <title>Blog · Notas y procesos</title>
    <meta
      name="description"
      content="Notas breves sobre diseño de producto, documentación de componentes y rendimiento en experiencias digitales."
    />
  </Fragment>

  <section class="card relative overflow-hidden p-8">
    <div class="absolute left-0 top-0 h-1 w-28 rounded-full ribbon" />
    <p class="text-xs uppercase tracking-[0.28em] text-slate-500">Blog</p>
    <h1 class="mt-2 text-3xl font-bold leading-tight text-slate-50 sm:text-4xl">Procesos detrás del portfolio</h1>
    <p class="mt-3 max-w-2xl text-base leading-relaxed text-slate-200/90">
      Apuntes breves sobre cómo diseño, documento y optimizo interfaces. Cada entrada es un snapshot de mi forma de trabajar y
      de las preguntas que aparecen en el día a día.
    </p>
  </section>

  <div class="mt-8 grid gap-6 lg:grid-cols-[1.6fr_1fr]">
    <div class="space-y-4">
      {sorted.map((post) => (
        <a
          class="block rounded-2xl bg-slate-900/60 p-6 ring-1 ring-inset ring-slate-800 transition hover:-translate-y-1 hover:bg-slate-900 hover:ring-slate-700"
          href={post.url}
        >
          <div class="flex flex-wrap items-center justify-between gap-3 text-sm text-slate-400">
            <span>{post.frontmatter.date}</span>
            {post.frontmatter.tags && (
              <div class="flex flex-wrap gap-2">
                {post.frontmatter.tags.map((tag: string) => (
                  <span class="rounded-full bg-slate-950/70 px-3 py-1 text-xs font-semibold text-slate-200 ring-1 ring-inset ring-slate-800">
                    {tag}
                  </span>
                ))}
              </div>
            )}
          </div>
          <h2 class="mt-3 text-2xl font-semibold text-slate-50">{post.frontmatter.title}</h2>
          <p class="mt-2 text-base leading-relaxed text-slate-200/90">{post.frontmatter.description}</p>
        </a>
      ))}
    </div>

    <aside class="card flex flex-col gap-6 p-6">
      <div>
        <p class="text-xs uppercase tracking-[0.25em] text-slate-500">Archivo rápido</p>
        <p class="mt-2 text-sm text-slate-200">
          Todas las entradas viven en Markdown para mantener el flujo de trabajo ligero y versionado. Puedes leerlas en el sitio
          o desde el repositorio.
        </p>
      </div>
      <div class="rounded-2xl bg-slate-900/50 p-5 ring-1 ring-inset ring-slate-800">
        <p class="text-sm font-semibold text-slate-100">Contacto</p>
        <p class="mt-2 text-sm text-slate-200/90">¿Quieres proponer un tema o colaborar en una publicación?</p>
        <a
          class="mt-3 inline-flex items-center gap-2 text-sm font-semibold text-emerald-300 transition hover:-translate-y-0.5 hover:text-emerald-200"
          href="mailto:hola@example.com"
        >
          Escríbeme a hola@example.com
        </a>
      </div>
    </aside>
  </div>
</BaseLayout>
